<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Summarizing the model results | pbj User’s Guide</title>
  <meta name="description" content="6 Summarizing the model results | pbj User’s Guide" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Summarizing the model results | pbj User’s Guide" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Summarizing the model results | pbj User’s Guide" />
  
  
  

<meta name="author" content="Simon Vandekar, Kaidi Kang, Anna Huang, Neil Woodward" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistical-inference-1.html"/>
<link rel="next" href="null-simulation-results.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="assets/table1-1.0/table1_defaults.css" rel="stylesheet" />
<script src="assets/core-js-2.5.3/shim.min.js"></script>
<script src="assets/react-17.0.0/react.min.js"></script>
<script src="assets/react-17.0.0/react-dom.min.js"></script>
<script src="assets/reactwidget-1.0.0/react-tools.js"></script>
<script src="assets/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="assets/reactable-0.4.4/reactable.css" rel="stylesheet" />
<script src="assets/reactable-binding-0.4.4/reactable.js"></script>
<link href="assets/papaya-0.1449/papaya.css" rel="stylesheet" />
<link href="assets/papaya-0.1449/base.css" rel="stylesheet" />
<script src="assets/papaya-0.1449/papaya.js"></script>
<script src="assets/papaya-0.1449/main.js"></script>
<script src="assets/papayaWidget-binding-0.7.1/papayaWidget.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="introduction.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction<span></span></a></li>
<li><a href="methods.html#methods" id="toc-methods"><span class="toc-section-number">2</span> Methods<span></span></a>
<ul>
<li><a href="methods.html#data-and-data-availability" id="toc-data-and-data-availability"><span class="toc-section-number">2.1</span> Data and data availability<span></span></a>
<ul>
<li><a href="methods.html#preprocessed-autism-brain-imaging-data-exchange" id="toc-preprocessed-autism-brain-imaging-data-exchange"><span class="toc-section-number">2.1.1</span> Preprocessed Autism Brain Imaging Data Exchange<span></span></a></li>
<li><a href="methods.html#twenty-one-pain-studies" id="toc-twenty-one-pain-studies"><span class="toc-section-number">2.1.2</span> Twenty-one pain studies<span></span></a></li>
<li><a href="methods.html#nathan-kline-institute-rockland-sample" id="toc-nathan-kline-institute-rockland-sample"><span class="toc-section-number">2.1.3</span> Nathan-Kline Institute Rockland Sample<span></span></a></li>
</ul></li>
<li><a href="methods.html#pbj-analysis-methods" id="toc-pbj-analysis-methods"><span class="toc-section-number">2.2</span> PBJ analysis methods<span></span></a>
<ul>
<li><a href="methods.html#model-estimation" id="toc-model-estimation"><span class="toc-section-number">2.2.1</span> Model estimation<span></span></a></li>
<li><a href="methods.html#statistical-inference" id="toc-statistical-inference"><span class="toc-section-number">2.2.2</span> Statistical inference<span></span></a></li>
</ul></li>
<li><a href="methods.html#evaluation-under-the-global-null-hypothesis" id="toc-evaluation-under-the-global-null-hypothesis"><span class="toc-section-number">2.3</span> Evaluation under the global null hypothesis<span></span></a>
<ul>
<li><a href="methods.html#null-synthetic-simulations" id="toc-null-synthetic-simulations"><span class="toc-section-number">2.3.1</span> Null synthetic simulations<span></span></a></li>
<li><a href="methods.html#null-bootstrap-simulations" id="toc-null-bootstrap-simulations"><span class="toc-section-number">2.3.2</span> Null bootstrap simulations<span></span></a></li>
</ul></li>
<li><a href="methods.html#evaluation-under-an-alternative-hypothesis" id="toc-evaluation-under-an-alternative-hypothesis"><span class="toc-section-number">2.4</span> Evaluation under an alternative hypothesis<span></span></a></li>
<li><a href="methods.html#synthetic-simulations" id="toc-synthetic-simulations"><span class="toc-section-number">2.5</span> Synthetic simulations<span></span></a></li>
<li><a href="methods.html#bootstrap-simulations" id="toc-bootstrap-simulations"><span class="toc-section-number">2.6</span> Bootstrap simulations<span></span></a></li>
</ul></li>
<li><a href="pbj-software-overview.html#pbj-software-overview" id="toc-pbj-software-overview"><span class="toc-section-number">3</span> <code>pbj</code> software overview<span></span></a>
<ul>
<li><a href="pbj-software-overview.html#installation" id="toc-installation"><span class="toc-section-number">3.1</span> Installation<span></span></a></li>
<li><a href="pbj-software-overview.html#analysis-setup" id="toc-analysis-setup"><span class="toc-section-number">3.2</span> Analysis setup<span></span></a></li>
<li><a href="pbj-software-overview.html#software-structure-and-general-workflow" id="toc-software-structure-and-general-workflow"><span class="toc-section-number">3.3</span> Software structure and general workflow<span></span></a>
<ul>
<li><a href="pbj-software-overview.html#lmPBJ" id="toc-lmPBJ"><span class="toc-section-number">3.3.1</span> Model estimation using the <code>lmPBJ</code> function<span></span></a></li>
<li><a href="pbj-software-overview.html#pbjInference" id="toc-pbjInference"><span class="toc-section-number">3.3.2</span> Statistical inference using the <code>pbjInference</code> function<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="pbj-tutorials.html#pbj-tutorials" id="toc-pbj-tutorials"><span class="toc-section-number">4</span> <code>pbj</code> tutorials<span></span></a>
<ul>
<li><a href="pbj-tutorials.html#preprocessed-abide-analysis" id="toc-preprocessed-abide-analysis"><span class="toc-section-number">4.1</span> Preprocessed ABIDE analysis<span></span></a>
<ul>
<li><a href="pbj-tutorials.html#whole-brain-exploratory-analysis" id="toc-whole-brain-exploratory-analysis"><span class="toc-section-number">4.1.1</span> Whole-brain exploratory analysis<span></span></a></li>
<li><a href="pbj-tutorials.html#voxel-wise-analysis-with-lmpbj" id="toc-voxel-wise-analysis-with-lmpbj"><span class="toc-section-number">4.1.2</span> Voxel-wise analysis with <code>lmPBJ</code><span></span></a></li>
<li><a href="pbj-tutorials.html#topological-inference-maxima-cei-cmi" id="toc-topological-inference-maxima-cei-cmi"><span class="toc-section-number">4.1.3</span> Topological inference (Maxima, CEI, CMI)<span></span></a></li>
<li><a href="pbj-tutorials.html#interpreting-and-visualizing-pbjinference-results" id="toc-interpreting-and-visualizing-pbjinference-results"><span class="toc-section-number">4.1.4</span> Interpreting and visualizing <code>pbjInference</code> results<span></span></a></li>
</ul></li>
<li><a href="pbj-tutorials.html#pain-meta-analysis" id="toc-pain-meta-analysis"><span class="toc-section-number">4.2</span> Pain meta-analysis<span></span></a>
<ul>
<li><a href="pbj-tutorials.html#pain-related-activation" id="toc-pain-related-activation"><span class="toc-section-number">4.2.1</span> Pain-related activation<span></span></a></li>
<li><a href="pbj-tutorials.html#software-related-differences-in-pain-meta-analysis" id="toc-software-related-differences-in-pain-meta-analysis"><span class="toc-section-number">4.2.2</span> Software related differences in pain meta-analysis<span></span></a></li>
</ul></li>
<li><a href="pbj-tutorials.html#nki-rs-analysis" id="toc-nki-rs-analysis"><span class="toc-section-number">4.3</span> NKI-RS analysis<span></span></a>
<ul>
<li><a href="pbj-tutorials.html#loading-data-and-basic-image-processing" id="toc-loading-data-and-basic-image-processing"><span class="toc-section-number">4.3.1</span> Loading data and basic image processing<span></span></a></li>
<li><a href="pbj-tutorials.html#model-specification" id="toc-model-specification"><span class="toc-section-number">4.3.2</span> Model specification<span></span></a></li>
<li><a href="pbj-tutorials.html#visualizing-the-results" id="toc-visualizing-the-results"><span class="toc-section-number">4.3.3</span> Visualizing the results<span></span></a></li>
<li><a href="pbj-tutorials.html#writing-the-results-and-viewing-interactively" id="toc-writing-the-results-and-viewing-interactively"><span class="toc-section-number">4.3.4</span> Writing the results and viewing interactively<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="statistical-inference-1.html#statistical-inference-1" id="toc-statistical-inference-1"><span class="toc-section-number">5</span> Statistical inference<span></span></a>
<ul>
<li><a href="statistical-inference-1.html#running-statistical-inference-for-the-robust-test-statistic-images" id="toc-running-statistical-inference-for-the-robust-test-statistic-images"><span class="toc-section-number">5.1</span> Running statistical inference for the robust test statistic images<span></span></a></li>
<li><a href="statistical-inference-1.html#ptfce-inference" id="toc-ptfce-inference"><span class="toc-section-number">5.2</span> pTFCE inference<span></span></a></li>
</ul></li>
<li><a href="summarizing-the-model-results.html#summarizing-the-model-results" id="toc-summarizing-the-model-results"><span class="toc-section-number">6</span> Summarizing the model results<span></span></a>
<ul>
<li><a href="summarizing-the-model-results.html#cluster-tables" id="toc-cluster-tables"><span class="toc-section-number">6.1</span> Cluster tables<span></span></a></li>
<li><a href="summarizing-the-model-results.html#writing-output-and-interactive-visualization" id="toc-writing-output-and-interactive-visualization"><span class="toc-section-number">6.2</span> Writing output and interactive visualization<span></span></a></li>
<li><a href="summarizing-the-model-results.html#creating-figures" id="toc-creating-figures"><span class="toc-section-number">6.3</span> Creating figures<span></span></a></li>
</ul></li>
<li><a href="null-simulation-results.html#null-simulation-results" id="toc-null-simulation-results"><span class="toc-section-number">7</span> Null simulation results<span></span></a>
<ul>
<li><a href="null-simulation-results.html#synthetic-null-simulations" id="toc-synthetic-null-simulations"><span class="toc-section-number">7.1</span> Synthetic null simulations<span></span></a></li>
<li><a href="null-simulation-results.html#bootstrap-null-simulations-using-a-factor-covariate" id="toc-bootstrap-null-simulations-using-a-factor-covariate"><span class="toc-section-number">7.2</span> Bootstrap null simulations using a factor covariate<span></span></a>
<ul>
<li><a href="null-simulation-results.html#marginal-distribution" id="toc-marginal-distribution"><span class="toc-section-number">7.2.1</span> Marginal distribution<span></span></a></li>
<li><a href="null-simulation-results.html#global-distributions" id="toc-global-distributions"><span class="toc-section-number">7.2.2</span> Global distributions<span></span></a></li>
</ul></li>
<li><a href="null-simulation-results.html#simulations-using-a-nonlinear-continuous-covariate" id="toc-simulations-using-a-nonlinear-continuous-covariate"><span class="toc-section-number">7.3</span> Simulations using a nonlinear continuous covariate<span></span></a>
<ul>
<li><a href="null-simulation-results.html#marginal-distribution-1" id="toc-marginal-distribution-1"><span class="toc-section-number">7.3.1</span> Marginal distribution<span></span></a></li>
<li><a href="null-simulation-results.html#global-distributions-1" id="toc-global-distributions-1"><span class="toc-section-number">7.3.2</span> Global distributions<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references" id="toc-references"><span class="toc-section-number">8</span> References<span></span></a></li>
<li><a href="appendix.html#appendix" id="toc-appendix"><span class="toc-section-number">9</span> Appendix<span></span></a></li>
<li><a href="supplementary-material.html#supplementary-material" id="toc-supplementary-material"><span class="toc-section-number">10</span> Supplementary Material<span></span></a>
<ul>
<li><a href="supplementary-material.html#nki-rs-voxel-based-morphometry-processing-and-quality-control" id="toc-nki-rs-voxel-based-morphometry-processing-and-quality-control"><span class="toc-section-number">10.1</span> NKI-RS Voxel-based morphometry processing and quality control<span></span></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">pbj User’s Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="summarizing-the-model-results" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Summarizing the model results<a href="summarizing-the-model-results.html#summarizing-the-model-results" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The <code>table.statMap</code> function can be used to visualize the statistical results for each topological feature.
The default is to present results for cluster extent inference using the first <code>cft</code> that was provided by the user.
The table is sorted largest to smallest by the topological features, in this case, the size of the cluster.
The two final columns are the unadjusted and adjusted p-values for each cluster.
Recall that these results are for the test of whether there is an age by sex interaction.
It looks like the first cluster adjusted p-value is “significant” by conventional standards.
We can use the write and visualization methods to export the results or make figures for publications.</p>
<div id="cluster-tables" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Cluster tables<a href="summarizing-the-model-results.html#cluster-tables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="summarizing-the-model-results.html#cb318-1" aria-hidden="true" tabindex="-1"></a>permTable <span class="ot">=</span> <span class="fu">table.statMap</span>(permStatMap)</span>
<span id="cb318-2"><a href="summarizing-the-model-results.html#cb318-2" aria-hidden="true" tabindex="-1"></a>robustTable <span class="ot">=</span> <span class="fu">table.statMap</span>(robustStatMap)</span>
<span id="cb318-3"><a href="summarizing-the-model-results.html#cb318-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This creates a table using the larger cluster forming threshold specified above.</span></span>
<span id="cb318-4"><a href="summarizing-the-model-results.html#cb318-4" aria-hidden="true" tabindex="-1"></a>stringentTable <span class="ot">=</span> <span class="fu">table.statMap</span>(robustStatMap, <span class="at">cft_p=</span>cft[<span class="dv">2</span>])</span>
<span id="cb318-5"><a href="summarizing-the-model-results.html#cb318-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-6"><a href="summarizing-the-model-results.html#cb318-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(permTable[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,], <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb318-7"><a href="summarizing-the-model-results.html#cb318-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">digits=</span><span class="dv">3</span>, <span class="at">booktabs=</span>T, <span class="at">caption =</span> <span class="st">&quot;Cluster summary table for permutation test results of the age by sex interaction.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:robustClusterTable">Table 6.1: </span>Cluster summary table for permutation test results of the age by sex interaction.</caption>
<thead>
<tr class="header">
<th align="right">Cluster ID</th>
<th align="right">Cluster Extent</th>
<th align="left">Centroid (vox)</th>
<th align="right">Max RESI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">375</td>
<td align="left">44, 88, 28</td>
<td align="right">0.223</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">183</td>
<td align="left">29, 33, 24</td>
<td align="right">0.203</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">142</td>
<td align="left">52, 39, 10</td>
<td align="right">0.187</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">140</td>
<td align="left">36, 27, 12</td>
<td align="right">0.154</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">134</td>
<td align="left">40, 58, 42</td>
<td align="right">0.188</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="summarizing-the-model-results.html#cb319-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(robustTable[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,], <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb319-2"><a href="summarizing-the-model-results.html#cb319-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">digits=</span><span class="dv">3</span>, <span class="at">booktabs=</span>T, <span class="at">caption =</span> <span class="st">&quot;Cluster summary table for wild bootstrap test results of the age by sex interaction.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:robustClusterTable">Table 6.1: </span>Cluster summary table for wild bootstrap test results of the age by sex interaction.</caption>
<thead>
<tr class="header">
<th align="right">Cluster ID</th>
<th align="right">Cluster Extent</th>
<th align="left">Centroid (vox)</th>
<th align="right">Max RESI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">375</td>
<td align="left">44, 88, 28</td>
<td align="right">0.223</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">183</td>
<td align="left">29, 33, 24</td>
<td align="right">0.203</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">142</td>
<td align="left">52, 39, 10</td>
<td align="right">0.187</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">140</td>
<td align="left">36, 27, 12</td>
<td align="right">0.154</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">134</td>
<td align="left">40, 58, 42</td>
<td align="right">0.188</td>
</tr>
</tbody>
</table>
</div>
<div id="writing-output-and-interactive-visualization" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Writing output and interactive visualization<a href="summarizing-the-model-results.html#writing-output-and-interactive-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="summarizing-the-model-results.html#cb320-1" aria-hidden="true" tabindex="-1"></a>pbjOutdir <span class="ot">=</span> <span class="fu">tempdir</span>()</span>
<span id="cb320-2"><a href="summarizing-the-model-results.html#cb320-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">write.statMap</span>(robustStatMap, pbjOutdir)</span>
<span id="cb320-3"><a href="summarizing-the-model-results.html#cb320-3" aria-hidden="true" tabindex="-1"></a><span class="co"># visualizes template with statistical map and adjusted p-values overlayed</span></span>
<span id="cb320-4"><a href="summarizing-the-model-results.html#cb320-4" aria-hidden="true" tabindex="-1"></a><span class="fu">papaya</span>(<span class="fu">c</span>(templatefile, result<span class="sc">$</span>stat, result<span class="sc">$</span>CEI1[<span class="dv">1</span>]))</span>
<span id="cb320-5"><a href="summarizing-the-model-results.html#cb320-5" aria-hidden="true" tabindex="-1"></a><span class="co">#papaya(c(templatefile, result$stat, result$CMI1[1]))</span></span></code></pre></div>
</div>
<div id="creating-figures" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Creating figures<a href="summarizing-the-model-results.html#creating-figures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="summarizing-the-model-results.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co">#image(robustStatMap, plane = &#39;axial&#39;, cft=cft[1], alpha=0.06, roi=1)</span></span>
<span id="cb321-2"><a href="summarizing-the-model-results.html#cb321-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-3"><a href="summarizing-the-model-results.html#cb321-3" aria-hidden="true" tabindex="-1"></a>rang <span class="ot">=</span> <span class="fu">range</span>(robustStatMap<span class="sc">$</span>stat)</span>
<span id="cb321-4"><a href="summarizing-the-model-results.html#cb321-4" aria-hidden="true" tabindex="-1"></a>layoutMat <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>) <span class="sc">%x%</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">3</span>) , <span class="dv">7</span>)</span>
<span id="cb321-5"><a href="summarizing-the-model-results.html#cb321-5" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(layoutMat)</span>
<span id="cb321-6"><a href="summarizing-the-model-results.html#cb321-6" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(robustStatMap, <span class="at">plane =</span> <span class="st">&#39;axial&#39;</span>, <span class="at">cft_p=</span>cft[<span class="dv">1</span>], <span class="at">alpha=</span><span class="fl">0.06</span>, <span class="at">slice=</span><span class="dv">26</span><span class="sc">:</span><span class="dv">31</span>, <span class="at">clusterID =</span> <span class="cn">FALSE</span>)</span>
<span id="cb321-7"><a href="summarizing-the-model-results.html#cb321-7" aria-hidden="true" tabindex="-1"></a><span class="co">#mtext(&#39;Probability&#39;, side=3, outer = TRUE, cex=1*cex, font=2)</span></span>
<span id="cb321-8"><a href="summarizing-the-model-results.html#cb321-8" aria-hidden="true" tabindex="-1"></a><span class="co"># these margins adjust the height and width of the color bar bottom,left,top,right</span></span>
<span id="cb321-9"><a href="summarizing-the-model-results.html#cb321-9" aria-hidden="true" tabindex="-1"></a>fgcol<span class="ot">=</span><span class="st">&#39;white&#39;</span></span>
<span id="cb321-10"><a href="summarizing-the-model-results.html#cb321-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="fl">0.5</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="fl">0.6</span>,<span class="dv">0</span>), <span class="at">fg=</span>fgcol, <span class="at">col.axis=</span>fgcol, <span class="at">col.lab=</span>fgcol, <span class="at">col.main =</span> fgcol, <span class="at">col.sub=</span>fgcol)</span>
<span id="cb321-11"><a href="summarizing-the-model-results.html#cb321-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colorBar</span>(pbj<span class="sc">:::</span><span class="fu">redyellow</span>(<span class="dv">64</span>), <span class="at">min=</span>cft[<span class="dv">1</span>], <span class="at">max=</span>rang[<span class="dv">2</span>], <span class="at">nticks=</span><span class="dv">4</span>, <span class="at">ylab =</span> <span class="st">&#39;Chi-sq&#39;</span>)</span></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistical-inference-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="null-simulation-results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
